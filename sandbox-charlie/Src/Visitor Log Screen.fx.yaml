"'Visitor Log Screen' As screen":

    coreVisitorLog As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =4

        labelVisitorLog As label:
            Align: =Align.Center
            Height: =71
            Size: =35
            Text: ="Visitor Log"
            Width: =1366
            Y: =82
            ZIndex: =1

        headerVisitorLog As Header:
            HomeVar: ='Home1 Screen'
            ZIndex: =2

        "sidenavVisitorLog As 'Hamburger Menu'":
            MenuItems: =collectionHamburgerMenu
            Width: =sidenavVisitorLog.MenuWidth
            ZIndex: =3

    galleriesSentry_1 As groupContainer:
        Height: =580
        Width: =1356
        X: =10
        Y: =110
        ZIndex: =5

        "galleryNotArrived_1 As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver4.0'":
            Fill: =PaleGoldenRod
            Height: =520
            Items: ='Visitor Log'
            Layout: =Layout.Vertical
            OnSelect: =Set(varSelectedGallery, ThisItem);Set(varSelectedVisitor, galleryNotArrived_1.Selected);Set(boolSentryModal, true);Set(boolCheck, false);Set(boolCheck, false)
            TemplateFill: |
                =If(
                    varSelectedGallery.ID = galleryNotArrived_1.Selected.ID && ThisItem.IsSelected,
                    RGBA(255, 255, 255, 0.75),
                     Switch(ThisItem.'Type of Visit'.Value, "Unclassified", ForestGreen, "Classified", DarkRed, "Unofficial", Gold, "Foreign", MediumPurple, "Check-in", RoyalBlue, "Family", SeaShell, "TopSecret", Orange, PaleGoldenRod)
                )
            TemplatePadding: =0
            TemplateSize: =Min(130, Self.Height - 60)
            Width: =476
            X: =40
            Y: =40
            ZIndex: =6

            Title2_1 As label:
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: |-
                    =If(
                        IsEmpty(galleryNotArrived_1),
                        "",
                        ThisItem.'Last Name' & ", " & ThisItem.'First Name'
                    )
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.TemplateWidth - 104
                X: =32
                Y: =16
                ZIndex: =1

            Subtitle1_4 As label:
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Title & " ("& ThisItem.'Type of Visit'.Value & ")"
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.TemplateWidth - 104
                X: =32
                Y: =Title2_1.Y + Title2_1.Height + 2
                ZIndex: =2

            Body1_4 As label:
                Height: =29
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Sponsor.DisplayName
                VerticalAlign: =VerticalAlign.Top
                Width: =223
                X: =32
                Y: =90
                ZIndex: =3

            Separator2_1 As rectangle:
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            Checkbox1 As checkbox:
                OnCheck: =Set(boolCheckIn, true)
                OnSelect: =Select(Parent)
                OnUncheck: =Set(boolCheckedIn, false);
                Text: ="Option"
                Width: =111
                X: =350
                Y: =40
                ZIndex: =6

    modalSentry_1 As groupContainer:
        Height: =768
        Visible: =modalSentry
        Width: =1366
        ZIndex: =6

        modalSentryExit_3 As button:
            Fill: =If(boolSentryModal, RGBA(179, 179, 179, 0.5), RGBA(255,255,255,0))
            Height: =768
            HoverFill: =ColorFade(RGBA(60, 60, 60, .5), -20%)
            OnSelect: =Set(boolSentryModal, false)
            Text: =""
            Visible: =boolSentryModal
            Width: =1366
            ZIndex: =1

        buttonCheckInOut_1 As button:
            OnSelect: |-
                =If(
                    varSelectedVisitor.'Base Status'.Value = "Not Arrived",
                    Patch(
                        'Visitor Log',
                        LookUp(
                            'Visitor Log',
                            Title = varSelectedVisitor.Title
                        ),
                        {'Base Status': {Value: "On-Base"}}
                    );
                    Office365Outlook.SendEmailV2(
                        varSelectedVisitor.Sponsor.Email,
                        "Your Visitor " & varSelectedVisitor.'First Name' & " " & varSelectedVisitor.'Last Name' & " has arrived!",
                        "Greetings " & varSelectedVisitor.Sponsor.DisplayName & "<br> Your visitor " & varSelectedVisitor.'First Name' & " " & varSelectedVisitor.'Last Name' & " has arrived and is ready to be picked up at the sentry station."
                    ),
                    If(
                        varSelectedVisitor.'Base Status'.Value = "On-Base",
                        Patch(
                            'Visitor Log',
                            LookUp(
                                'Visitor Log',
                                Title = varSelectedVisitor.Title
                            ),
                            {'Base Status': {Value: "Checked-Out"}}
                        ),
                        false
                    )
                );
                Set(
                    boolSentryModal,
                    false
                )
            Text: =If(varSelectedVisitor.'Base Status'.Value = "Not Arrived", "Check-in", If(varSelectedVisitor.'Base Status'.Value = "On-Base", "Check-out", "Exit"))
            X: =603
            Y: =587
            ZIndex: =3

        buttonCheckInOut_2 As button:
            OnSelect: |
                =Set(boolCheck, true); Set(checkedIn, false);
            Text: ="Valid"
            X: =807
            Y: =587
            ZIndex: =4

        Button4 As button:
            Text: ="Button"
            X: =742
            Y: =557
            ZIndex: =5

    FormViewer1_2 As formViewer:
        DataSource: ='Visitor Log'
        Fill: =RGBA(255, 255, 255, 1)
        Item: =varSelectedVisitor
        Visible: =boolSentryModal
        Width: =532
        X: =521
        Y: =153
        ZIndex: =7

    Button5_3 As button:
        Height: =216
        OnSelect: =Set(checkedIn, false); Set(boolCheck, true)
        Text: ="Check-out"
        Width: =231
        X: =1072
        Y: =384
        ZIndex: =8

    Button5_2 As button:
        Height: =216
        OnSelect: =Set(checkedIn, true);Set(boolCheck, false)
        Text: ="Check-in"
        Width: =231
        X: =1072
        Y: =168
        ZIndex: =9

    Button5_4 As button:
        Height: =89
        OnSelect: =Set(checkedIn, true);Set(boolCheck, false)
        Text: ="Assign Serial Number"
        Width: =254
        X: =660
        Y: =600
        ZIndex: =10

