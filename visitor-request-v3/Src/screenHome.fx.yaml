screenHome As screen:

    containerScreenHome As groupContainer.manualLayoutContainer:
        Height: =screenHome.Height
        Width: =screenHome.Width
        ZIndex: =4

        buttonRequest_1 As icon.CancelBadge:
            Height: =150
            Icon: =Icon.CancelBadge
            OnSelect: =Navigate(screenRequest);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            Rotation: =45
            Width: =150
            X: =1216
            Y: =618
            ZIndex: =1

        buttonSecurity_1 As icon.CancelBadge:
            Height: =150
            Icon: =Icon.CheckBadge
            OnSelect: =Navigate(screenSecurity);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            Width: =150
            Y: =618
            ZIndex: =2

        searchBarRequest As text:
            Default: =""
            HintText: ="Search"
            PaddingLeft: =40
            Size: =15
            Width: =galleryRequests.Width//320
            X: =150
            Y: =103
            ZIndex: =3

        iconSearch As icon.Search:
            Color: =RGBA(128, 128, 128, 1)
            Height: =28
            Icon: =Icon.Search
            Width: =44
            X: =150
            Y: =110
            ZIndex: =4

        galleryButtons As gallery.galleryHorizontal:
            Height: =90
            Items: =collectionApproved
            ShowScrollbar: =false
            TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(320, Self.Width - 60), Min(320, Self.Height - 60))
            Width: =872
            X: =235
            Y: =110
            ZIndex: =5

            Button6 As button:
                Color: =RGBA(0, 0, 0, 1)
                Fill: |-
                    =If(ThisItem.Selected,
                    
                    Switch(Button6.Text,
                    
                    "Approved", RGBA(0, 177, 106, 1),
                    
                    "Pending", RGBA(255, 255, 126, 1), 
                    
                    "Denied", RGBA(240, 52, 24, 1)),
                    
                    ColorFade(
                        Switch(Button6.Text,
                    
                    "Approved", RGBA(0, 177, 106, 1),
                    
                    "Pending", RGBA(255, 255, 126, 1), 
                    
                    "Denied", RGBA(240, 52, 24, 1)), 0.85))
                    
                    /*
                    If(ThisItem.Selected,
                    
                    Switch(Button6.Text,
                    
                    "Approved", RGBA(0, 177, 106, 1),
                    
                    "Pending", RGBA(255, 246, 143, 1), 
                    
                    "Denied", RGBA(240, 52, 24, 1)),
                    
                    ColorFade(
                        Switch(Button6.Text,
                    
                    "Approved", RGBA(0, 177, 106, 1),
                    
                    "Pending", RGBA(255, 246, 143, 1), 
                    
                    "Denied", RGBA(240, 52, 24, 1)), 0.7))
                    
                    
                    
                    
                    
                    If(ThisItem.Selected,
                    
                    Switch(Button6.Text,
                    
                    "Approved", RGBA(38, 166, 91, 1),
                    
                    "Pending", PaleGoldenRod, 
                    
                    "Denied", RGBA(240, 52, 24, 1)),
                    
                    ColorFade(
                        Switch(Button6.Text,
                    
                    "Approved", RGBA(38, 166, 91, 1),
                    
                    "Pending", PaleGoldenRod, 
                    
                    "Denied", RGBA(240, 52, 24, 1)), 0.7))
                    */
                    /*If(ThisItem.Selected,
                    
                    Switch(Button6.Text,
                    
                    "Approved", PaleGreen,
                    
                    "Pending", PaleGoldenRod, 
                    
                    "Denied", RGBA(240, 52, 24, 1)),
                    
                    ColorFade(
                        Switch(Button6.Text,
                    
                    "Approved", PaleGreen,
                    
                    "Pending", PaleGoldenRod, 
                    
                    "Denied", RGBA(240, 52, 24, 1)), 0.7))
                    */
                    //If(ThisItem.Selected, RGBA(56, 96, 178, 1), ColorFade(RGBA(56, 96, 178, 1),0.7))
                HoverFill: |-
                    =ColorFade(Switch(Button6.Text,
                    
                    "Approved", RGBA(0, 177, 106, 1),
                    
                    "Pending", RGBA(255, 255, 126, 1), 
                    
                    "Denied", RGBA(240, 52, 24, 1)
                    ), -20%)
                    
                    //ColorFade(RGBA(56, 96, 178, 1), -20%)
                OnSelect: |-
                    =UpdateIf(collectionApproved,Value = ThisItem.Value, {Selected:!Selected})
                Text: =ThisItem.Value
                X: =40
                Y: =40
                ZIndex: =1

        comboBoxButtons As combobox:
            DefaultSelectedItems: =Filter(collectionApproved, Selected)
            DisplayFields: =["Value"]
            Height: =35
            InputTextPlaceholder: |-
                ="Reasons for Denial
                "
            IsSearchable: =false
            Items: =Choices(VisitorRequest.Approved)
            NoSelectionText: ="All"
            SearchFields: =["Value"]
            SearchItems: =[]
            Visible: =false
            Width: =68
            X: =1257
            Y: =103
            ZIndex: =6

        Button1 As button:
            Height: =30
            OnSelect: =Navigate(screenSecurity)
            Text: ="Button"
            Width: =110
            X: =20
            Y: =539
            ZIndex: =8

        Icon1 As icon.Reset:
            Height: =27
            Icon: =Icon.Reset
            OnSelect: |-
                =UpdateIf(collectionApproved, true, {Selected:false}); Reset(ddDateFilter); Reset(searchBarRequest)
            Width: =33
            X: =1168
            Y: =164
            ZIndex: =9

        headerSecurity As Header_2:
            HomeVar: =screenHome
            ZIndex: =10

        ddDateFilter As combobox:
            DisplayFields: =["DisplayName"]
            InputTextPlaceholder: ="Start Date"
            Items: =collectionDateFilter
            PaddingLeft: =10
            Reset: =true
            SearchFields: =["DisplayName"]
            SearchItems: =Search(collectionDateFilter,ddDateFilter.SearchText,"DisplayName")
            SelectMultiple: =false
            Size: =15
            Width: =150
            X: =1066
            Y: =103
            ZIndex: =11

        galleryRequests As gallery.galleryVertical:
            BorderColor: =RGBA(0, 0, 0, 0)
            Height: =568
            Items: |-
                =SortByColumns(
                If(isSecurity,
                    Search(
                    Filter(
                        VisitorRequest,
                          IsBlank(comboBoxButtons.SelectedItems) || IsEmpty(comboBoxButtons.SelectedItems) || Approved.Value in comboBoxButtons.SelectedItems.Value,
                         IsBlank(ddDateFilter.Selected) || 'Visit Start Date' >= ddDateFilter.Selected.StartDate && 'Visit Start Date' <= ddDateFilter.Selected.EndDate
                    ),
                    searchBarRequest.Text,
                    "LastName",
                    "FirstName",
                    "Title"
                ),
                    Search(
                    Filter(
                        VisitorRequest,
                        Lower(Sponsor.Email) = Lower(CURRENTUSER.Email), IsBlank(comboBoxButtons.SelectedItems) || IsEmpty(comboBoxButtons.SelectedItems) || Approved.Value in comboBoxButtons.SelectedItems.Value,
                         IsBlank(ddDateFilter.Selected) || 'Visit Start Date' >= ddDateFilter.Selected.StartDate && 'Visit Start Date' <= ddDateFilter.Selected.EndDate
                    ),
                    searchBarRequest.Text,
                    "LastName",
                    "FirstName",
                    "Title"
                )),
                "LastName",
                    Ascending)
                
                
                
                
                    /*SortByColumns(
                If(!isSecurity,
                    Search(
                    Filter(
                        VisitorRequest,
                         Lower(Sponsor.Email) = Lower(currentUser.Email), IsBlank(ComboBoxCheckBox.SelectedItems) || IsEmpty(ComboBoxCheckBox.SelectedItems) || Approved.Value in ComboBoxCheckBox.SelectedItems.Value,
                         IsBlank(ddDateFilter.Selected) || 'Visit Start Date' >= ddDateFilter.Selected.StartDate && 'Visit Start Date' <= ddDateFilter.Selected.EndDate
                    ),
                    searchBarRequest.Text,
                    "LastName",
                    "FirstName",
                    "Title"
                ),
                    Search(
                    Filter(
                        VisitorRequest,
                        IsBlank(ComboBoxCheckBox.SelectedItems) || IsEmpty(ComboBoxCheckBox.SelectedItems) || Approved.Value in ComboBoxCheckBox.SelectedItems.Value,
                         IsBlank(ddDateFilter.Selected) || 'Visit Start Date' >= ddDateFilter.Selected.StartDate && 'Visit Start Date' <= ddDateFilter.Selected.EndDate
                    ),
                    searchBarRequest.Text,
                    "LastName",
                    "FirstName",
                    "Title"
                )),
                "LastName",
                    Ascending)*/
                    
                    /*SortByColumns(
                Search(
                    Filter(
                        VisitorRequest,
                        If(isSecurity, Lower(Sponsor.Email) = Lower(currentUser.Email), IsBlank(ComboBoxCheckBox.SelectedItems) || IsEmpty(ComboBoxCheckBox.SelectedItems) || Approved.Value in ComboBoxCheckBox.SelectedItems.Value,
                         IsBlank(ddDateFilter.Selected) || 'Visit Start Date' >= ddDateFilter.Selected.StartDate && 'Visit Start Date' <= ddDateFilter.Selected.EndDate)
                    ),
                    searchBarRequest.Text,
                    "LastName",
                    "FirstName",
                    "Title"
                ),
                "LastName",
                    Ascending)*/
                
                    /*
                    SortByColumns(
                Search(
                    Filter(
                        VisitorRequest,
                        If(isSecurity, Lower(Sponsor.Email) = Lower(currentUser.Email), IsBlank(ComboBoxCheckBox.SelectedItems) || IsEmpty(ComboBoxCheckBox.SelectedItems) || Approved.Value in ComboBoxCheckBox.SelectedItems.Value,
                         IsBlank(ddDateFilter.Selected) || 'Visit Start Date' >= ddDateFilter.Selected.StartDate && 'Visit Start Date' <= ddDateFilter.Selected.EndDate)
                    ),
                    searchBarRequest.Text,
                    "LastName",
                    "FirstName",
                    "Title"
                ),
                "LastName",
                    Ascending)
                    */
                
                   
                    
                    /*SortByColumns(
                Search(
                    Filter(
                        VisitorRequest,
                        IsBlank(ComboBoxCheckBox.SelectedItems) || IsEmpty(ComboBoxCheckBox.SelectedItems) || Approved.Value in ComboBoxCheckBox.SelectedItems.Value,
                         IsBlank(ddDateFilter.Selected) || 'Visit Start Date' >= ddDateFilter.Selected.StartDate && 'Visit Start Date' <= ddDateFilter.Selected.EndDate,
                        If(isSecurity, Lower(Sponsor.Email) = Lower(currentUser.Email))
                    ),
                    searchBarRequest.Text,
                    "LastName",
                    "FirstName",
                    "Title"
                ),
                "LastName",
                    Ascending)*/
                    /*
                    SortByColumns(
                Search(
                    Filter(
                        VisitorRequest,
                        IsBlank(ComboBox1_4.SelectedItems) || IsEmpty(ComboBox1_4.SelectedItems) || Approved.Value in ComboBox1_4.SelectedItems.Value
                    ),
                    searchBarRequest.Text,
                    "LastName",
                    "FirstName",
                    "Title"
                ),
                "LastName",
                    Ascending)
                    */
                
                
                /*SortByColumns(
                    If( 
                        IsBlank(searchBarRequest.Text) && ddDateFilter.Selected.Value = "All",
                            Filter(
                            VisitorRequest,
                            Approved.Value = VarStatus),
                        If(
                            IsBlank(searchBarRequest.Text) && ddDateFilter.Selected.Value = "This Month",
                            With(
                                {
                                    StartDate: Date(
                                        Year(Today()),
                                        Month(Today()),
                                        1
                                    ),
                                    EndDate: Date(
                                        Year(Today()),
                                        Month(Today()) + 1,
                                        1
                                    ) - 1
                                },
                                Filter(
                                    VisitorRequest,
                                    'Visit Start Date' >= StartDate,
                                    'Visit Start Date' <= EndDate,
                                     Approved.Value = VarStatus
                                )
                            ),
                            If(
                                IsBlank(searchBarRequest.Text) && ddDateFilter.Selected.Value = "Next Month",
                                With(
                                    {
                                        StartDate: Date(
                                            Year(Today()),
                                            Month(Today()) + 1,
                                            1
                                        ),
                                        EndDate: Date(
                                            Year(Today()),
                                            Month(Today()) + 2,
                                            1
                                        ) - 1
                                    },
                                    Filter(
                                        VisitorRequest,
                                        'Visit Start Date' >= StartDate,
                                        'Visit Start Date' <= EndDate,
                                         Approved.Value = VarStatus
                                    )
                                ),
                                If(
                                    IsBlank(searchBarRequest.Text) && ddDateFilter.Selected.Value = "Next Quarter",
                                    With(
                                        {
                                            StartDate: Date(
                                                Year(Today()),
                                                Month(Today()),
                                                Day(Today())
                                            ),
                                            EndDate: Date(
                                                Year(Today()),
                                                Month(Today()) + 3,
                                                Day(Today())
                                            ) - 1
                                        },
                                        Filter(
                                            VisitorRequest,
                                            'Visit Start Date' >= StartDate,
                                            'Visit Start Date' <= EndDate,
                                             Approved.Value = VarStatus
                                        )
                                    ),
                                    Search(
                                        VisitorRequest,
                                        searchBarRequest.Text,
                                        "LastName","FirstName","Title"
                                    )
                                )
                            )
                        )
                    ),
                    "LastName",
                    Ascending
                )
                /*,
                        'Visit Start Date'>=Slider1.Value*/
            Layout: =Layout.Vertical
            OnSelect: |-
                =Set(formData, galleryRequests.Selected);
                If(
                    DateDiff(
                        formData.'Visit Start Date',
                        formData.'Visit End Date',
                        Days
                    ) >= 90 && formData.'Days a Week Working at MCTSSA'.Value = "Five Days",
                    Set(
                        isLongTerm,
                        true
                    ),
                    Set(
                        isLongTerm,
                        false
                    )
                );
                
                If(isSecurity,
                Set(isModalSecurity, true),
                If(formData.Approved.Value <> "Approved",
                Set(isModalRequest, true);
                Set(isEventPage, true),
                Set(isModalSecurity, true)));
                //ViewForm('formSecurity');
                Set(varRecord, ThisItem)
                
                
                
                    
            ShowNavigation: =true
            ShowScrollbar: =false
            TabIndex: |
                =-1
            TemplateFill: |-
                =If(ThisItem.ID = varRecord.ID, ColorFade(Gray, .45), LightGray) //LightGray
                //c
                /*
                
                
                If(ThisItem.IsSelected, ColorFade(Gray, .45), LightGray)
                
                Switch(ThisItem.Approved.Value,
                
                "Approved", PaleGreen,
                
                "Pending", PaleGoldenRod, 
                
                "Denied", RGBA(240, 52, 24, 1)
                )
                //RGBA(240, 52, 24, 1) RGBA(196, 77, 65, 1)
                */
            TemplatePadding: =10
            TemplateSize: =130
            Transition: =Transition.Push
            Width: =1064
            WrapCount: =4
            X: =150
            Y: =200
            ZIndex: =12

            Rectangle2 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =1
                Fill: |
                    =Switch(ThisItem.Approved.Value,
                    
                    "Approved", RGBA(0, 177, 106, 1),
                    
                    "Pending", RGBA(255, 255, 126, 1)/*RGBA(255, 255, 126, 1)*/, 
                    
                    "Denied", RGBA(240, 52, 24, 1)
                    )
                    //RGBA(240, 52, 24, 1) RGBA(196, 77, 65, 1)
                Height: =24
                Width: =Parent.TemplateWidth
                ZIndex: =1

            Rectangle3 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0)
                Height: =130
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                X: |
                    =0
                ZIndex: =2

            Label3 As label:
                Align: =Center
                FontWeight: =FontWeight.Semibold
                OnSelect: =Select(Parent)
                PaddingBottom: =2
                PaddingTop: =2
                Size: =14
                Text: |-
                    =If(
                        IsEmpty(galleryRequests),
                        "",
                        ThisItem.'Last Name' & ", " & ThisItem.'First Name'
                    )
                Width: =Parent.TemplateWidth
                Y: =22
                ZIndex: =3

            Label3_1 As label:
                Align: =Center
                OnSelect: =Select(Parent)
                PaddingBottom: =2
                PaddingTop: =2
                Size: =11
                Text: |
                    =ThisItem.Title
                Width: =Parent.TemplateWidth
                Y: =45
                ZIndex: =4

            Label3_2 As label:
                Align: =Center
                OnSelect: =Select(Parent)
                PaddingBottom: =2
                PaddingTop: =2
                Size: =10
                Text: |
                    =ThisItem.'Visit Start Date' &" - " & ThisItem.'Visit End Date'
                Width: =Parent.TemplateWidth
                Y: =65
                ZIndex: =5

            Label3_3 As label:
                Align: =Center
                OnSelect: =Select(Parent)
                PaddingBottom: =2
                PaddingTop: =2
                Size: =10
                Text: |-
                    ="Sponsor:" & " " & ThisItem.Sponsor.DisplayName
                Width: =Parent.TemplateWidth
                Y: =82
                ZIndex: =6

            Label5 As label:
                Align: =Center
                FontWeight: =FontWeight.Bold
                Height: =24
                OnSelect: =Select(Parent)
                Size: =11
                Text: |
                    =ThisItem.Approved.Value
                     
                        
                Width: =Parent.TemplateWidth
                ZIndex: =7

            Label3_4 As label:
                Align: =Center
                FontWeight: =FontWeight.Semibold
                Height: =24
                Italic: =true
                OnSelect: =Select(Parent)
                PaddingBottom: =2
                PaddingTop: =2
                Size: =10
                Text: |-
                    =If(
                        ThisItem.Approved.Value = "Denied",
                        ThisItem.'Denied Reason'.Value
                        )
                        
                Width: =Parent.TemplateWidth
                Y: =106
                ZIndex: =8

